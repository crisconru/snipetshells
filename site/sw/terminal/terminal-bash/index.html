<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Bash - Tips de Cristo</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Bash Scripting", url: "#_top", children: [
              {title: "Ficheros Bash", url: "#ficheros-bash" },
              {title: "Variables", url: "#variables" },
              {title: "Sintaxis", url: "#sintaxis" },
              {title: "Recorrer ficheros externos", url: "#recorrer-ficheros-externos" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../tmux/tmux-comandos/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../tmux/tmux-comandos/" class="btn btn-xs btn-link">
        Comandos
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../redes/redes-ipv6/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../redes/redes-ipv6/" class="btn btn-xs btn-link">
        IPv6
      </a>
    </div>
    
  </div>

    

    <h1 id="bash-scripting">Bash Scripting</h1>
<p>Los scripts de bash sirven sobre todo para automatización.</p>
<h2 id="ficheros-bash">Ficheros Bash</h2>
<p>Suelen acabar con la extensión <code>.sh</code>, aunque no es obligatorio. Lo que si es obligatorio es que empiecen con el shebang (comando que empieza por <code>#</code> en la primera linea del fichero) que indica como hay que ejecutar el fichero.</p>
<pre><code class="bash">#!/bin/bash
</code></pre>

<p>En entornos viejos probablemente haya que poner</p>
<pre><code class="bash">#!/bin/sh
</code></pre>

<h3 id="ejecucion">Ejecución</h3>
<p>Se pueden ejecutar desde la shell haciendo:</p>
<ol>
<li><code>./&lt;fichero&gt;</code></li>
<li><code>sh &lt;fichero&gt;</code></li>
<li><code>bash &lt;fichero&gt;</code></li>
<li>Situándolo dentro de uno de los directorios especiales <code>/usr/local/bin</code> o <code>/usr/bin</code></li>
</ol>
<p>Deberían de tener permisos de lectura como de ejecución. </p>
<h2 id="variables">Variables</h2>
<p>Las variables serían <code>&lt;variable&gt;=&lt;valor&gt;</code>, sin espacios en el igual. Existen diferentes tipos:</p>
<ul>
<li>String:<ul>
<li>El valor va entre comillas dobles <code>nombre="Paco Pepe"</code>.</li>
</ul>
</li>
<li>Numérica:<ul>
<li>Sin comillas y en un solo bloque <code>numero=1977</code>.</li>
</ul>
</li>
<li>Array (lista):<ul>
<li>Valores entre paréntesis y separados por un espacio <code>lista=(Paco Pepe Hernandez)</code>.</li>
<li>Empiezan por la posición cero.</li>
<li>Se accede a un elemento concreto usando corchetes <code>lista[0]="Paco"</code>.</li>
<li>Se pueden añadir elementos <code>lista[3]="Fernandez</code>.</li>
</ul>
</li>
<li>Salida de comando:<ul>
<li>Se declara entre tildes invertidas ` <code>fichero='cat fichero.sh'</code></li>
</ul>
</li>
</ul>
<p>Para poder usar una variable anteriormente definida, <strong>EXCEPTO LOS ARRAYS</strong>, se puede usar:</p>
<ul>
<li><code>$</code> -&gt; <code>Mi nombre es $nombre</code>.</li>
<li><code>(())</code> -&gt; <code>((numero++))</code> ó <code>((numero=numero+1))</code>.</li>
<li><code>let ""</code> -&gt; <code>let "numero++"</code> ó <code>let "numero=numero+1</code>.</li>
</ul>
<p>Variable <code>$?</code>:</p>
<ul>
<li>Si se ha ejecutado un comando anterior, podemos recoger el valor que devuelve con esta variable.</li>
<li>Si el comando se ha ejecutado sin problemas, devuelve 0.</li>
<li>Si da algun problema, devuelve otro número / cosa.<ul>
<li>Para saber que devuelve el comando hay que mirar su man page -&gt; <code>man &lt;comando&gt;</code>.</li>
</ul>
</li>
</ul>
<h3 id="arrays">Arrays</h3>
<ul>
<li>Declaración:<ul>
<li>Directamente -&gt; <code>lista=(uno dos tres)</code></li>
<li>Poco a poco -&gt; <code>lista=[0]="uno"; lista[1]="dos"; lista[2]="tres"</code>.</li>
</ul>
</li>
<li>Uso con <code>${}</code><ul>
<li><code>$lista</code> -&gt; Devuelve solo el primer elemento.</li>
<li><code>$lista[3]</code> -&gt; Sigue devolviendo el primer elemento junto con las letras <code>[3]</code>.</li>
<li><code>${lista}</code> -&gt; Devuelve solo el primer elemento.</li>
<li><code>${lista[3]}</code> -&gt; Devuelve el cuarto elemento.</li>
<li><code>${lista[*]}</code> -&gt; Devuelve todo el array.</li>
<li><code>${#lista[*]}</code> -&gt; Devuelve el número de elementos que contiene el array.</li>
<li><code>${#lista[1]}</code> -&gt; Devuelve el número de elementos que tiene el segundo elemento del array.</li>
</ul>
</li>
<li>Borrar con <code>unset</code>:<ul>
<li><code>unset lista[1]</code> -&gt; Borra el segundo elemento.</li>
<li><code>unset lista</code> -&gt; Borra todo el array.</li>
</ul>
</li>
</ul>
<h2 id="sintaxis">Sintaxis</h2>
<ul>
<li>No es obligatorio con las tabulaciones.</li>
<li>Si es muy porculero con los espacios, sobre todo en condiciones, bucles, y demás.</li>
<li>Los comentarios empiezan por <code>#</code>.</li>
<li>Se pueden poner varias instrucciones por linea separándolas por <code>;</code>.</li>
<li>La sentencia <code>set -u</code> después del shebang inicial ayuda a indicar errores de gramática (poner mal el nombre de una variable).</li>
</ul>
<h3 id="operadores">Operadores</h3>
<ul>
<li>Operadores booleanes:<ul>
<li><code>true</code>.</li>
<li><code>false</code>.</li>
</ul>
</li>
<li>Operadores matemáticos:<ul>
<li><code>+</code> -&gt; Suma.</li>
<li><code>-</code> -&gt; Resta.</li>
<li><code>*</code> -&gt; Multiplicación.</li>
<li><code>/</code> -&gt; Division.</li>
<li><code>%</code> -&gt; Módulo.</li>
</ul>
</li>
<li>Comparaciones lógicas:<ul>
<li><code>-lt</code> / <code>-gt</code> -&gt; Menor (&lt;) / mayor (&gt;) que.</li>
<li><code>-le</code> / <code>-ge</code> -&gt; Menor o igual (&lt;=) / mayor o igual (&gt;=) que.</li>
<li><code>-eq</code> / <code>-ne</code> -&gt; Igual (==) / distinto (!=) que.</li>
<li><code>z</code> / <code>n</code> -&gt; Nulo (ningún carácter) / no nulo (al menos un carácter).</li>
<li><code>-a</code> ó <code>&amp;&amp;</code> -&gt; AND.</li>
<li><code>-o</code> ó <code>||</code> -&gt; OR.</li>
</ul>
</li>
<li>Operadores condicionales de ficheros:<ul>
<li><code>-e</code> -&gt; Si existe.</li>
<li><code>-f</code> -&gt; Si existe y NO es un directorio.</li>
<li><code>-d</code> -&gt; Si existe y NO es un fichero.</li>
<li><code>-s</code> -&gt; Si existe y no está vacío.</li>
<li><code>-r</code> -&gt; Si existe y tiene permisos de lectura.</li>
<li><code>-w</code> -&gt; Si existe y tiene permisos de escritura.</li>
<li><code>-x</code> -&gt; Si existe y tiene permisos de ejecución.</li>
</ul>
</li>
</ul>
<h3 id="argumentos-de-entrada">Argumentos de entrada</h3>
<p><code>./&lt;fichero&gt; &lt;arg1&gt; &lt;arg2&gt; &lt;arg3&gt;</code></p>
<p>El argumento 0 sería el nombre del propio fichero. Los demás argumentos van separados por espacios. Dentro del fichero podemos usar los argumentos con:</p>
<ul>
<li><code>$0</code> -&gt; Primer argumento (nombre del script).</li>
<li><code>$1</code> -&gt; Segundo argumento.</li>
<li><code>$...</code></li>
</ul>
<p>Se pueden usar como un array:</p>
<ul>
<li><code>$*</code> -&gt; Todos los argumentos en formato string (sin <code>$0</code>).</li>
<li><code>$@</code> -&gt; Todos los argumentos en formato array (sin <code>$0</code>).</li>
<li><code>$#</code> -&gt; Número de argumentos (sin <code>$0</code>).</li>
</ul>
<p>Puedes leer argumentos interactivamente con <code>read &lt;variable&gt;</code></p>
<pre><code class="bash">#!/bin/bash

echo &quot;Introduce tu nombre&quot;
read nombre

read -p &quot;Ahora el apellido&quot; apellido

echo &quot;Te llamas $nombre $apellido
</code></pre>

<h3 id="exit"><code>exit</code></h3>
<p>Existe un comando para salir de un script en un momento concreto y devolver un valor estimado.</p>
<pre><code class="bash">exit &lt;valor&gt;
</code></pre>

<p><code>exit 1</code> -&gt; Saldría del script devolviendo 1.
<code>exit</code> -&gt; Saldría del script devolviendo el valor de la variable <code>$?</code> de dentro del script.</p>
<h3 id="if">if</h3>
<pre><code class="bash">if [ &lt;condicion&gt; ]; then
    &lt;comandos&gt;
elif [ &lt;condicion&gt;]; then
    &lt;comandos&gt;
else
    &lt;comandos&gt;
fi
</code></pre>

<p>Si la <code>&lt;condicion&gt;</code> es un string, deberías de poner <code>[[ &lt;condicion&gt; ]]</code> en lugar de <code>[ &lt;condicion&gt; ]</code>.</p>
<h3 id="case">case</h3>
<pre><code class="bash">case &lt;variable&gt; in
    &lt;opcion1&gt;)
        &lt;comandos&gt;
        ;;
    &lt;opcion2&gt;|&lt;opcion3&gt;)
        &lt;comandos&gt;
        ;;
    &lt;opcion4&gt;)
        &lt;comandos&gt;
        ;;
    *)
        &lt;comandos&gt;
esac
</code></pre>

<p>En las <code>&lt;opcion&gt;</code> podemos hacer lo siguiente, si quisiera que se leyera <code>make</code> o <code>Make</code>, haríamos que <code>&lt;opcion&gt;</code> sea <code>[Mm]ake</code>.</p>
<h3 id="while">while</h3>
<pre><code class="bash">while (( &lt;condicion&gt; ))
do
    &lt;comandos&gt;
done
</code></pre>

<h3 id="for">for</h3>
<pre><code class="bash">for &lt;elemento&gt; in &lt;array&gt;
do
    &lt;comandos&gt;
done
</code></pre>

<p>Se recomienda usar la <code>@</code> en los arrays de los <code>for</code> en lugar de <code>*</code>. Ejemplo:</p>
<pre><code class="bash">#!/bin/bash

lista=(uno dos tres)
for i in ${lista[@]}
do
    echo &quot;Elemento $i&quot;
done
</code></pre>

<h2 id="recorrer-ficheros-externos">Recorrer ficheros externos</h2>
<p>Con <code>while</code> leemos líneas:</p>
<pre><code class="bash">while read LINE
do
    &lt;comandos&gt;
done &lt; &lt;fichero&gt;
</code></pre>

<p>Con <code>for</code> leemos palabras:</p>
<pre><code class="bash">for &lt;elemento&gt; in &lt;contenido-fichero&gt;
do
    &lt;comandos&gt;
done
</code></pre>

<p>Un ejemplo, le paso <code>sh ejemplo.sh mifichero.txt</code>:</p>
<pre><code class="bash">#!/bin/bash

fichero=$1
pos=1
while read LINE
do
    echo &quot;Linea $pos: $LINE&quot;
    ((pos++))
done &lt; $fichero

palabras=`cat $fichero`
for palabra in $palabras
do
    echo $palabra
done
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../tmux/tmux-comandos/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../tmux/tmux-comandos/" class="btn btn-xs btn-link">
        Comandos
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../redes/redes-ipv6/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../redes/redes-ipv6/" class="btn btn-xs btn-link">
        IPv6
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>